:root {
    --bg-color: #121212;
    --card-bg: #1e1e1e;
    --input-bg: #2d2d2d;
    --modal-bg: #252525;
    --text-main: #e0e0e0;
    --text-muted: #a0a0a0;
    --accent: #bb86fc;
    --accent-hover: #9965f4;
    --border: #333;

    /* Status Colors */
    --g-green: #00e676;
    --g-amber: #ffb300;
    --g-red: #ff1744;
    --g-grey: #666666;
    /* Chart Colors */
    --chart-1: #03dac6;
    --chart-2: #ff4081;
}

* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }

body {
    background-color: var(--bg-color);
    color: var(--text-main);
    padding: 2rem;
    min-height: 100vh;
    padding-bottom: 4rem;
}
header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 2rem; border-bottom: 1px solid var(--border); padding-bottom: 1.5rem;
    gap: 1.5rem; flex-wrap: wrap;
    position: sticky; top: 0; z-index: 1000; background-color: var(--bg-color);
}
.header-left { display: flex; align-items: center; gap: 15px; }
.header-logo-img { width: 48px; height: 48px; object-fit: contain; }

#appTitle {
    font-weight: 300; letter-spacing: 1px; color: var(--accent); margin: 0;
    border-bottom: 1px dashed transparent; cursor: text; transition: border 0.2s;
}
#appTitle:hover { border-bottom-color: var(--accent); }
#appTitle:focus { outline: none; border-bottom: 1px solid var(--accent); }
.date-display { color: var(--text-muted); font-size: 0.9rem; font-family: monospace; margin-top: 5px; }
.header-actions { display: flex; gap: 0.8rem; align-items: center; flex-wrap: wrap; }

.btn {
    background: var(--input-bg); border: 1px solid var(--accent); color: var(--accent);
    padding: 0.6rem 1.2rem; border-radius: 4px; cursor: pointer; font-size: 0.85rem;
    transition: all 0.2s; font-weight: 600;
}
.btn:hover { background: var(--accent); color: #000; }
.btn-primary { background: var(--accent); color: #000; }
.btn-primary:hover { background: var(--accent-hover); }
.btn-sm { padding: 0.4rem 0.8rem; font-size: 0.75rem; }

.btn-reset {
    background: transparent; border: 1px solid #444; color: var(--text-muted);
    padding: 2px 8px; border-radius: 3px; cursor: pointer; font-size: 0.7rem;
    margin-top: 0.8rem; width: auto; display: inline-block; transition: all 0.2s;
}
.btn-reset:hover { border-color: var(--g-red); color: var(--g-red); }

.team-overview-panel {
    background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 8px;
    padding: 1.5rem; margin-bottom: 2rem; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 2rem;
}
.overview-col h4 {
    color: var(--accent); font-size: 0.85rem; text-transform: uppercase;
    border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; margin-bottom: 0.5rem;
}
.date-suffix { color: var(--text-muted); font-weight: normal; font-size: 0.8em; margin-left: 8px; text-transform: none; }
.edit-hint { font-size: 0.7rem; color: #666; font-style: italic; margin-bottom: 1rem; display: block; }
.overview-list { list-style: none; font-size: 0.9rem; line-height: 1.4; color: var(--text-main); }
.overview-list li { margin-bottom: 0.5rem; position: relative; padding-left: 1rem; }
.overview-list li::before { content: "•"; position: absolute; left: 0; color: #fff; }
.auto-item { color: var(--text-main); }
.auto-item b { color: var(--text-muted); margin-right: 5px; }
.overview-col.interactive {
    cursor: pointer; position: relative; transition: background 0.2s; border-radius: 4px; padding: 0.5rem; margin: -0.5rem;
}
.overview-col.interactive:hover { background: rgba(255,255,255,0.05); }
.overview-col.interactive::after {
    content: "✎"; position: absolute; top: 0.5rem; right: 0.5rem; color: var(--text-muted); opacity: 0; transition: opacity 0.2s;
}
.overview-col.interactive:hover::after { opacity: 1; }
#additionalInfoPreview { font-size: 0.9rem; line-height: 1.5; color: var(--text-main); pointer-events: none; }
#additionalInfoPreview ul { padding-left: 1.2rem; margin-bottom: 0.5rem; }
#additionalInfoPreview li { margin-bottom: 0.2rem; }
#additionalInfoPreview b { color: #fff; }
#additionalInfoPreview a { color: var(--chart-1); text-decoration: none; border-bottom: 1px dashed var(--chart-1); cursor: pointer; pointer-events: auto; }
#additionalInfoPreview a:hover { border-bottom-style: solid; }
.section-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;
}
.section-header.first { border-top: none; padding-top: 0; }
.tracker-grid {
    display: flex; flex-wrap: wrap; gap: 1.5rem; margin-bottom: 3rem;
}
.tracker-card {
    background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 8px;
    padding: 1rem; text-align: center; position: relative; cursor: pointer; transition: transform 0.2s;
    min-height: 280px; display: flex; flex-direction: column; justify-content: space-between;
    flex-grow: 1;
}
.tracker-card.size-S { flex-basis: calc(20% - 1.5rem); max-width: calc(20% - 1.5rem); }
.tracker-card.size-M { flex-basis: calc(33.333% - 1.5rem); max-width: calc(33.333% - 1.5rem); }
.tracker-card.size-L { flex-basis: calc(50% - 1.5rem); max-width: calc(50% - 1.5rem); }
.tracker-card.size-XL { flex-basis: 100%; max-width: 100%; }

/* Fallback for smaller screens */
@media (max-width: 1200px) {
    .tracker-card.size-S { flex-basis: calc(33.333% - 1.5rem); max-width: calc(33.333% - 1.5rem); }
}
@media (max-width: 768px) {
    .tracker-card.size-S, .tracker-card.size-M, .tracker-card.size-L { flex-basis: 100%; max-width: 100%; }
}

.tracker-card:hover { border-color: var(--accent); transform: translateY(-2px); }
.tracker-desc { font-weight: bold; margin-bottom: 1rem; color: var(--text-main); height: 30px; display: flex; align-items: center; justify-content: center;}
.tracker-viz-container { flex-grow: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 160px; overflow: hidden; padding: 0 5px; }
.tracker-viz-container > div { width: 100% !important; }
.tracker-card.dragging { opacity: 0.5; border: 2px dashed var(--accent); }
.tracker-grid.drag-active .tracker-card { cursor: grabbing; }
.pie-chart {
    width: 100%; aspect-ratio: 1 / 1; max-height: 160px; max-width: 160px;
    border-radius: 50%; margin: 0 auto;
    background: conic-gradient(var(--g-green) 0% 0%, var(--g-red) 0% 100%);
    position: relative; box-shadow: 0 0 10px rgba(0,0,0,0.5);
    flex-shrink: 0;
}
.donut-chart {
    width: 100%; height: 100%;
    margin: 0 auto;
    position: relative;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
}
.status-select-col { display: flex; flex-direction: column; gap: 5px; width: 30%; }
.status-option {
    width: 100%; padding: 8px; border-radius: 4px; text-align: center; cursor: pointer;
    font-weight: bold; font-size: 0.8rem; opacity: 0.5; border: 1px solid #444; color: #000;
}
/* Ensure workload pills take full width of their container */
.ls-box { text-align: center; flex: 1; }
.pill-group .w-pill { width: 100%; }

.average-pill {
    position: absolute; top: 10px; right: 10px; padding: 4px 8px; border-radius: 12px;
    font-size: 0.7rem; font-weight: bold; color: #000; box-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

.pie-overlay {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    background: var(--card-bg); width: 96px; height: 96px; border-radius: 50%;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
}
.pie-pct { font-size: 1.4rem; font-weight: bold; color: var(--text-main); }
.tracker-stats { font-size: 0.8rem; color: var(--text-muted); margin-top: auto; padding-top:1rem; }
.btn-del-tracker {
    position: absolute; top: 10px; right: 10px; color: #666; background: none; border: none; cursor: pointer; font-size: 1.2rem; z-index: 2;
}
.btn-del-tracker:hover { color: var(--g-red); }
.team-grid { display: grid; grid-template-columns: 1fr; gap: 2rem; width: 100%; }
.member-card {
    background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 12px;
    transition: transform 0.2s; position: relative; cursor: pointer; overflow: hidden;
    display: flex; flex-direction: column; padding: 0; box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    width: 100%; margin-bottom: 1rem;
}
.member-card:hover { border-color: var(--accent); transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.6); }

/* 3-Column User Card Layout */
.member-card-content {
    display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; padding: 1.5rem; flex-grow: 1;
}
.card-col {
    display: flex; flex-direction: column; gap: 1rem; padding: 1.5rem;
    background: rgba(255,255,255,0.02); border-radius: 8px; border: 1px solid #333;
    min-height: 200px;
}
.col-header { 
    font-size: 0.85rem; text-transform: uppercase; color: var(--accent); 
    font-weight: bold; text-align: center; border-bottom: 1px solid #444; padding-bottom: 10px; margin-bottom: 10px;
    letter-spacing: 1px;
}
#globalTooltip {
    position: fixed; background: #222; color: #fff; padding: 10px; border: 1px solid #555;
    border-radius: 4px; font-size: 0.8rem; white-space: pre-wrap; width: 220px;
    z-index: 99999; box-shadow: 0 4px 15px rgba(0,0,0,0.8); pointer-events: none; display: none; line-height: 1.4;
}
.help-icon {
    display: inline-block; width: 16px; height: 16px; background: #444; color: #aaa;
    border-radius: 50%; text-align: center; line-height: 16px; font-size: 11px; font-weight: bold;
    cursor: help; margin-left: 6px; vertical-align: middle;
}
.help-icon:hover { background: var(--accent); color: #000; }
.modal-overlay {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); z-index: 1000; align-items: center; justify-content: center;
}
#alertModal, #confirmModal { z-index: 2000; }
.modal-overlay.active { display: flex; }
.modal-content {
    background: var(--modal-bg); width: 95%; max-width: 900px; max-height: 90vh;
    border-radius: 8px; border: 1px solid var(--border); display: flex; flex-direction: column;
    box-shadow: 0 10px 40px rgba(0,0,0,0.8);
}
.modal-mini { max-width: 400px; text-align: center; }
.modal-large { width: 90%; height: 85%; max-width: 1200px; }
.modal-header { padding: 1.5rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
.modal-body { padding: 2rem; overflow-y: auto; flex-grow: 1; }
.modal-footer { padding: 1.5rem; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 1rem; }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
.form-section-title { color: var(--accent); font-size: 0.9rem; text-transform: uppercase; margin-bottom: 1rem; border-bottom: 1px solid #444; padding-bottom: 0.5rem; }
.input-group { margin-bottom: 1rem; }
.input-group label { display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.4rem; }
input[type="text"], input[type="number"], input[type="date"], textarea {
    width: 100%; padding: 0.6rem; background: var(--input-bg); border: 1px solid var(--border);
    color: #fff; border-radius: 4px; font-size: 0.9rem;
}
input:focus, textarea:focus { border-color: var(--accent); outline: none; }
.load-select-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
.ls-box { text-align: center; } .ls-box label { font-size: 0.7rem; margin-bottom: 2px; }
select { width: 100%; padding: 4px; background: var(--input-bg); color: #fff; border: 1px solid var(--border); text-align: center; border-radius: 4px; cursor: pointer; }
option { background: var(--input-bg); color: #fff; }
.type-selector { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
.type-option {
    padding: 0.8rem; border: 1px solid var(--border); border-radius: 4px; cursor: pointer; color: var(--text-muted);
    background: transparent; font-weight: bold; font-size: 0.8rem; text-align: center;
}
.type-option:hover { background: rgba(255,255,255,0.05); }
.type-option.active { background: var(--accent); color: #000; border-color: var(--accent); }
#barSeriesContainer, #lineSeriesContainer {
    max-height: 300px; overflow-y: auto; padding-right: 5px; border: 1px solid var(--border); border-radius: 4px; padding: 10px; background: rgba(0,0,0,0.2);
}
.grid-24 { display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; }
input[type="color"] {
    -webkit-appearance: none; border: 1px solid #444; width: 40px; height: 40px; cursor: pointer; background: none; padding: 0; vertical-align: middle;
}
input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
input[type="color"]::-webkit-color-swatch { border: none; border-radius: 4px; }
input[type="color"]::-moz-color-swatch { border: none; border-radius: 4px; }
.counter-display { font-size: 3rem; font-weight: 300; color: var(--accent); line-height: 1; text-shadow: 0 0 20px rgba(187, 134, 252, 0.3); }
.counter-sub { font-size: 0.9rem; color: var(--text-muted); margin-top: 5px; }
.ryg-indicator {
    width: 80px; height: 80px; border-radius: 50%; margin: 0 auto; transition: background 0.3s, box-shadow 0.3s;
    display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; color: #000;
}
.ryg-green { background: var(--g-green); box-shadow: 0 0 15px var(--g-green); }
.ryg-amber { background: var(--g-amber); box-shadow: 0 0 15px var(--g-amber); }
.ryg-red { background: var(--g-red); box-shadow: 0 0 15px var(--g-red); }
.ryg-grey { background: var(--g-grey); box-shadow: none; color: #fff; }
.rag-selector { display: flex; gap: 1rem; margin-top: 5px; }
.rag-pill {
    flex: 1; padding: 10px; border: 2px solid transparent; border-radius: 8px; 
    text-align: center; cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; justify-content: center;
    background: rgba(255,255,255,0.05);
}
.rag-pill:hover { background: rgba(255,255,255,0.1); }
.rag-pill.active { border-color: var(--accent); background: rgba(187, 134, 252, 0.1); transform: scale(1.05); }
.rag-pill svg { display: block; }
#wafflePreview { display: grid; grid-template-columns: repeat(10, 1fr); gap: 1px; width: 60px; margin: 10px auto; }
.waffle-cell { aspect-ratio: 1; background: #333; border-radius: 1px; }
body.publishing .header-actions, body.publishing .btn-del-tracker, body.publishing .section-header button, body.publishing .overview-col.interactive::after, body.publishing .edit-hint, body.publishing .help-icon, body.publishing .btn-reset { display: none !important; }
body.publishing #publishToggleBtn { display: block !important; position: fixed; top: 20px; right: 20px; z-index: 9999; }
body.publishing .auto-item b { display: none; }
body.publishing .tracker-card { cursor: default; }
body.publishing .tracker-card.type-line, 
body.publishing .tracker-card.type-bar, 
body.publishing .tracker-card.type-note, 
body.publishing .tracker-card.type-rag, 
body.publishing .tracker-card.type-ryg, 
body.publishing .tracker-card.type-waffle { 
    cursor: zoom-in; 
}
body.publishing .member-card { cursor: default; }
body.publishing #appTitle { pointer-events: none; border-bottom: none; }
body.publishing .overview-col.interactive { pointer-events: auto; }
body.publishing .overview-col { cursor: zoom-in; }
body.publishing .overview-col:hover { background: rgba(255,255,255,0.05); }
body.publishing #additionalInfoPreview { pointer-events: auto; }
#publishToggleBtn { display: none; }
.zoomed-content ul { font-size: 1.5rem; line-height: 2; padding-left: 2rem; }
.zoomed-content li { margin-bottom: 1rem; }
.zoomed-content p { font-size: 1.2rem; line-height: 1.6; }
.zoomed-content b { color: #fff; }
.zoomed-content a { color: var(--chart-1); text-decoration: none; border-bottom: 1px dashed var(--chart-1); }
@media print {
    body { background: #121212 !important; color: #e0e0e0 !important; -webkit-print-color-adjust: exact; }
    .header-actions, .modal-overlay, .btn, .btn-del-tracker, #publishToggleBtn, .btn-reset { display: none !important; }
    .member-card, .team-overview-panel, .tracker-card { break-inside: avoid; border: 1px solid #444 !important; }
    .card-top { background: #1a1a1a !important; }
    .section-header button { display: none; }
    body.publishing .auto-item b { display: none; }
}

/* Modal Pills */
.pill-group { display: flex; flex-direction: column; gap: 5px; margin-top: 5px; }
.w-pill {
    width: 100%; height: 24px; border-radius: 4px; font-size: 0.7rem; font-weight: bold;
    display: flex; align-items: center; justify-content: center; cursor: pointer;
    border: 1px solid #444; color: #000; opacity: 0.4; transition: all 0.2s;
}
.w-pill:hover { opacity: 0.8; }
.w-pill.selected { opacity: 1; border-color: #fff; box-shadow: 0 0 5px rgba(255,255,255,0.2); }

.wp-l { background-color: var(--g-amber); } /* Yellow */
.wp-n { background-color: var(--g-green); } /* Green */
.wp-r { background-color: var(--g-red); color: #fff; }   /* Red */
.wp-x { background-color: var(--accent); }  /* Purple */

.status-select-col { display: flex; flex-direction: column; gap: 5px; width: 30%; }
.status-option {
    width: 100%; padding: 8px; border-radius: 4px; text-align: center; cursor: pointer;
    font-weight: bold; font-size: 0.8rem; opacity: 0.5; border: 1px solid #444; color: #000;
}
.status-option.selected { opacity: 1; border-color: #fff; }
.so-busy { background-color: var(--g-green); }
.so-under { background-color: var(--g-amber); }
.so-over { background-color: var(--g-red); color: #fff; }
.so-absent { background-color: var(--accent); color: #fff; opacity: 0.7; }

.daily-mini-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; margin-top: 15px; padding: 0 10px; }
.dm-box { text-align: center; background: var(--input-bg); padding: 6px 2px; border-radius: 4px; }
.dm-day { font-size: 0.65rem; color: var(--text-muted); display: block; margin-bottom: 2px; }
.dm-val { font-size: 0.85rem; font-weight: bold; }

/* Status Pill Rendering */
.status-pill {
    padding: 8px 12px; border-radius: 20px; font-size: 0.9rem; font-weight: bold;
    text-align: center; color: #000; display: inline-block; width: 80%; margin: 0 auto;
}

/* Fix val-L rendering if used in pills or text */
.val-L { color: #000 !important; background-color: var(--g-amber); padding: 2px 5px; border-radius: 4px; }
.val-N { color: #000 !important; background-color: var(--g-green); padding: 2px 5px; border-radius: 4px; }
.val-R { color: #fff !important; background-color: var(--g-red); padding: 2px 5px; border-radius: 4px; }
.val-X { color: #fff !important; background-color: var(--accent); opacity: 0.7; font-weight: normal; padding: 2px 5px; border-radius: 4px; }

/* 3-Column User Card Layout */
.member-card-content {
    display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; padding: 1.5rem; flex-grow: 1;
}
.card-col {
    display: flex; flex-direction: column; gap: 1rem; padding: 1.5rem;
    background: rgba(255,255,255,0.02); border-radius: 8px; border: 1px solid #333;
    min-height: 200px;
}
.col-header { 
    font-size: 0.85rem; text-transform: uppercase; color: var(--accent); 
    font-weight: bold; text-align: center; border-bottom: 1px solid #444; padding-bottom: 10px; margin-bottom: 10px;
    letter-spacing: 1px;
}

.card-task-li { margin-bottom: 0.8rem; display: flex; gap: 10px; align-items: flex-start; line-height: 1.4; }
.card-task-li input[type="checkbox"] { margin-top: 4px; accent-color: var(--accent); transform: scale(1.2); }

.status-under { background-color: var(--g-amber); color: #000; }
.status-busy { background-color: var(--g-green); color: #000; }
.status-over { background-color: var(--g-red); color: #fff; }
.status-absent { background-color: var(--accent); color: #fff; opacity: 0.8; }

.note-render-container {
    max-height: 100%; overflow-y: auto; width: 100%; height: 100%;
    padding: 10px; font-size: 0.9rem; line-height: 1.4; color: var(--text-main);
}
/* Purple Scrollbar for Note Container */
.note-render-container::-webkit-scrollbar { width: 6px; }
.note-render-container::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
.note-render-container::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 3px; }
.note-render-container::-webkit-scrollbar-thumb:hover { background: var(--accent-hover); }

.zoomed-content ul { list-style: none; font-size: 1.5rem; line-height: 2; padding-left: 1rem; }
.zoomed-content li { margin-bottom: 1rem; position: relative; padding-left: 2rem; }
.zoomed-content li::before { content: "★"; position: absolute; left: 0; color: gold; font-size: 1.5rem; line-height: 2; }