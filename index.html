<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Platforms Tracker v31</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="logo.svg">
    <!-- Load Styles -->
    <link rel="stylesheet" href="styles.css">
    <!-- Load ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>
    
    <!-- NEW: LOADING OVERLAY -->
    <div id="loadingOverlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-color); z-index:99999; display:flex; justify-content:center; align-items:center;">
        <h1 style="color:var(--accent);">Server Platforms Tracker v31</h1>
        <p style="color:var(--text-muted); margin-left: 15px;">Initializing...</p>
    </div>

    <div class="app-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="logo.svg" alt="Logo" class="sidebar-logo">
                <h2 id="appTitleSidebar" contenteditable="true" spellcheck="false" onblur="App.saveTitle()" style="font-size:1.2rem; font-weight:300; color:var(--accent); margin:0; outline:none; border-bottom:1px dashed transparent;">Server Platforms</h2>
            </div>
            
            <nav class="sidebar-nav">
                <button id="navTrackers" class="nav-item active" onclick="App.switchView('trackers')">Cards</button>
                <button id="navTeam" class="nav-item" onclick="App.switchView('team')">Team Data</button>
            </nav>
            
            <div class="sidebar-bottom">
                <input type="file" id="fileInput" style="display: none;" accept=".json,.csv" onchange="DataLoader.loadFromFile(this)">
                <button class="btn btn-block" onclick="document.getElementById('fileInput').click()">Load Data</button>
                <button class="btn btn-block" onclick="DataSaver.saveData()">Save JSON</button>
                <button class="btn btn-block btn-primary" onclick="App.togglePublishMode()">Publish View</button>
                <button class="btn btn-block" onclick="App.toggleTheme()">Day/Night Theme</button>
            </div>
        </aside>
        
        <main class="main-content">
            <div class="content-header">
                <h1 id="pageTitle" style="font-weight:300; color:var(--text-main);">Cards</h1>
                <div class="date-display" id="dateRangeDisplay">...</div>
            </div>
            
            <!-- TRACKERS VIEW -->
            <div id="viewTrackers" class="view-section">
                <div class="section-header first">
                    <button class="btn" onclick="TrackerManager.openModal(-1)">+ Add Card</button>
                </div>
                <div class="tracker-grid" id="trackerGrid"></div>
            </div>
            
            <!-- TEAM DATA VIEW -->
            <div id="viewTeamData" class="view-section" style="display:none;">
                <div class="team-overview-panel">
                    <div class="overview-col" onclick="OverviewManager.handleOverviewClick('success')">
                        <h4 id="overviewTitleCurrent">Top 5 Team Achievements</h4>
                        <div class="edit-hint">(Check max 5 boxes in Last Week)</div>
                        <ul class="overview-list" id="teamSuccessList"><li>No items selected.</li></ul>
                        <button class="btn-reset" onclick="event.stopPropagation(); UserManager.resetSelections('success')">Reset Selection</button>
                    </div>
                    <div class="overview-col" onclick="OverviewManager.handleOverviewClick('activity')">
                        <h4 id="overviewTitleNext">Top 5 Activities Next Week</h4>
                        <div class="edit-hint">(Check max 5 boxes in Next Week)</div>
                        <ul class="overview-list" id="teamActivityList"><li>No items selected.</li></ul>
                        <button class="btn-reset" onclick="event.stopPropagation(); UserManager.resetSelections('activity')">Reset Selection</button>
                    </div>
                    <div class="overview-col interactive" onclick="OverviewManager.handleInfoClick()">
                        <h4>Additional Info</h4>
                        <div class="edit-hint">(Click anywhere to edit)</div>
                        <div id="additionalInfoPreview"></div>
                    </div>
                </div>
                
                <div id="assignmentsSection" style="margin-bottom: 3rem;">
                    <div class="section-header">
                        <h3 style="color:var(--accent); font-weight:300;">Assignments</h3>
                        <button class="btn" onclick="AssignmentManager.openModal(-1)">+ Add Assignment</button>
                    </div>
                    <div id="assignmentsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;"></div>
                </div>
                
                <div id="ganttSection" style="margin-bottom: 3rem;">
                    <div class="section-header">
                        <h3 style="color:var(--accent); font-weight:300;">Resource Planner</h3>
                        <button class="btn" onclick="PlannerManager.openModal(-1)">+ Add Planner</button>
                    </div>
                    <div id="ganttContainer" style="background:var(--card-bg); border:1px solid var(--border); border-radius:8px; padding:1rem; overflow-x:auto;"></div>
                    <div id="additionalPlannersContainer" style="margin-top: 2rem; display: flex; flex-direction: column; gap: 2rem;"></div>
                </div>

                <div class="section-header" id="teamSectionHeader">
                    <h3 style="color:var(--accent); font-weight:300;">Team Members</h3>
                    <button class="btn btn-primary" onclick="UserManager.openUserModal()">+ Add User</button>
                </div>
                <div class="team-grid" id="teamGrid"></div>
            </div>
            <!-- ROLES VIEW -->
            <div id="viewRoles" class="view-section" style="display:none;">
                <div class="section-header first">
                    <h3 style="color:var(--accent); font-weight:300;">Roles</h3>
                    <button class="btn" onclick="RoleManager.openModal(-1)">+ Add Role</button>
                </div>
                <div id="rolesGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;"></div>
            </div>

            <!-- EVENTS VIEW -->
            <div id="viewEvents" class="view-section" style="display:none;">
                <div class="section-header first">
                    <h3 style="color:var(--accent); font-weight:300;">Events</h3>
                    <button class="btn" onclick="EventManager.openModal(-1)">+ Add Event</button>
                </div>
                <div id="eventsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;"></div>
            </div>

            <!-- TASKS VIEW -->
            <div id="viewTasks" class="view-section" style="display:none;">
                <div class="section-header first">
                    <h3 style="color:var(--accent); font-weight:300;">Tasks</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="taskSortSelect" onchange="TaskManager.render()" style="background:var(--card-bg); border:1px solid var(--border); color:var(--text-muted); padding:5px; border-radius:4px; width:auto; font-size:0.8rem;">
                            <option value="default">Sort by: Default</option>
                            <option value="priority">Sort by: Priority</option>
                            <option value="start">Sort by: Start Date</option>
                            <option value="end">Sort by: End Date</option>
                        </select>
                        <button class="btn" onclick="TaskManager.openModal(-1)">+ Add Task</button>
                    </div>
                </div>
                <div id="tasksGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;"></div>
            </div>
        </main>
    </div>

    <!-- TOOLTIP & MODALS -->
    <div id="globalTooltip"></div>
    
    <div class="modal-overlay" id="alertModal">
        <div class="modal-content modal-mini">
            <div class="modal-body" style="padding-bottom:1rem;">
                <h3 style="margin-bottom:1rem; color:var(--accent);">Notice</h3>
                <p id="alertMessage" style="font-size:1rem; color:#fff;"></p>
            </div>
            <div class="modal-footer" style="justify-content:center; border-top:none;">
                <button class="btn btn-primary" onclick="ModalManager.closeModal('alertModal')">OK</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-content modal-mini">
            <div class="modal-body" style="padding-bottom:1rem;">
                <h3 style="margin-bottom:1rem; color:var(--accent);">Confirm</h3>
                <p id="confirmMessage" style="font-size:1rem; color:#fff;"></p>
            </div>
            <div class="modal-footer" style="justify-content:center; border-top:none; gap:1rem;">
                <button class="btn" onclick="ModalManager.closeModal('confirmModal')">Cancel</button>
                <button id="confirmYesBtn" class="btn btn-primary">Yes, Proceed</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="zoomModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="zoomTitle" style="font-size:1.5rem;">View</h3>
                <button class="btn" onclick="ModalManager.closeModal('zoomModal')">&times;</button>
            </div>
            <div class="modal-body" id="zoomBody"></div>
        </div>
    </div>

    <div class="modal-overlay" id="colorPickerModal" style="z-index: 3000;">
        <div class="modal-content modal-mini" style="max-width: 600px;">
            <div class="modal-header">
                <h3 style="color:var(--accent);">Select Color</h3>
                <button class="btn" onclick="ModalManager.closeModal('colorPickerModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="colorPickerGrid" class="color-picker-grid"></div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Add User</h3>
                <button class="btn" onclick="ModalManager.closeModal('userModal')" style="padding: 0.2rem 0.6rem;">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editIndex" value="-1">
                <div class="input-group">
                    <label>Team Member Name <span class="help-icon" data-text="Enter full name of team member.">?</span></label>
                    <input type="text" id="mName" placeholder="e.g. Alex Chen">
                </div>
                <div class="form-row tri-form" style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:1rem;">
                    <div class="col-form">
                        <div class="form-section-title" id="lastWeekTitle">Last Week</div>
                        <div class="input-group">
                            <label>Top 3 Successes</label>
                            <input type="text" class="mb-2" id="lwTask1" placeholder="1. Project A...">
                            <input type="text" class="mb-2" id="lwTask2" style="margin-top:5px" placeholder="2. Client Call...">
                            <input type="text" class="mb-2" id="lwTask3" style="margin-top:5px" placeholder="3. Bug fix...">
                        </div>
                    </div>
                    <div class="col-form">
                        <div class="form-section-title" id="thisWeekTitle">Current Week</div>
                        <div class="input-group">
                            <label>Top 3 Priorities</label>
                            <input type="text" class="mb-2" id="nwTask1" placeholder="1. Start Phase 2...">
                            <input type="text" class="mb-2" id="nwTask2" style="margin-top:5px" placeholder="2. Planning...">
                            <input type="text" class="mb-2" id="nwTask3" style="margin-top:5px" placeholder="3. Code Review...">
                        </div>
                        <div class="input-group">
                            <label>Availability <span style="font-size:0.7rem; font-weight:normal; color:#888;">(Checkbox = On-Call)</span></label>
                            <div class="load-select-row">
                                <div class="ls-box"><label>M</label><input type="hidden" id="nw0" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(0,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(0,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(0,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(0,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc0" title="On Call"></div></div>
                                <div class="ls-box"><label>T</label><input type="hidden" id="nw1" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(1,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(1,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(1,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(1,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc1" title="On Call"></div></div>
                                <div class="ls-box"><label>W</label><input type="hidden" id="nw2" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(2,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(2,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(2,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(2,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc2" title="On Call"></div></div>
                                <div class="ls-box"><label>T</label><input type="hidden" id="nw3" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(3,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(3,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(3,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(3,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc3" title="On Call"></div></div>
                                <div class="ls-box"><label>F</label><input type="hidden" id="nw4" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(4,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(4,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(4,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(4,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc4" title="On Call"></div></div>
                                <div class="ls-box"><label>S</label><input type="hidden" id="nw5" value="X"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(5,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(5,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(5,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(5,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc5" title="On Call"></div></div>
                                <div class="ls-box"><label>S</label><input type="hidden" id="nw6" value="X"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setLoad(6,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setLoad(6,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setLoad(6,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setLoad(6,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="nwOc6" title="On Call"></div></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-form">
                        <div class="form-section-title" id="nextWeekTitle">Next Week</div>
                        <div class="input-group">
                            <label>Planned Work</label>
                            <input type="text" class="mb-2" id="fwTask1" placeholder="1. Future Task...">
                            <input type="text" class="mb-2" id="fwTask2" style="margin-top:5px" placeholder="2. Future Task...">
                            <input type="text" class="mb-2" id="fwTask3" style="margin-top:5px" placeholder="3. Future Task...">
                        </div>
                        <div class="input-group">
                            <label>Availability <span style="font-size:0.7rem; font-weight:normal; color:#888;">(Checkbox = On-Call)</span></label>
                            <div class="load-select-row">
                                <div class="ls-box"><label>M</label><input type="hidden" id="fw0" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(0,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(0,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(0,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(0,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc0" title="On Call"></div></div>
                                <div class="ls-box"><label>T</label><input type="hidden" id="fw1" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(1,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(1,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(1,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(1,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc1" title="On Call"></div></div>
                                <div class="ls-box"><label>W</label><input type="hidden" id="fw2" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(2,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(2,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(2,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(2,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc2" title="On Call"></div></div>
                                <div class="ls-box"><label>T</label><input type="hidden" id="fw3" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(3,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(3,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(3,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(3,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc3" title="On Call"></div></div>
                                <div class="ls-box"><label>F</label><input type="hidden" id="fw4" value="N"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(4,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(4,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(4,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(4,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc4" title="On Call"></div></div>
                                <div class="ls-box"><label>S</label><input type="hidden" id="fw5" value="X"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(5,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(5,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(5,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(5,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc5" title="On Call"></div></div>
                                <div class="ls-box"><label>S</label><input type="hidden" id="fw6" value="X"><div class="pill-group"><div class="w-pill wp-l" onclick="UserManager.setFutureLoad(6,'L')">L</div><div class="w-pill wp-n" onclick="UserManager.setFutureLoad(6,'N')">M</div><div class="w-pill wp-r" onclick="UserManager.setFutureLoad(6,'R')">H</div><div class="w-pill wp-x" onclick="UserManager.setFutureLoad(6,'X')">A</div></div><div style="margin-top:2px;"><input type="checkbox" id="fwOc6" title="On Call"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="input-group" style="margin-top: 1rem;">
                    <label>Notes (Max 200 chars)</label>
                    <textarea id="mNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="General notes, key updates..."></textarea>
                </div>
                
                <div class="input-group" style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <label>Long Term Objectives (Max 24)</label>
                        <button class="btn btn-sm" onclick="UserManager.addObjectiveRow()">+ Add Objective</button>
                    </div>
                    <div id="objectivesContainer" style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 4px; background: rgba(0,0,0,0.1); margin-top:5px; display:flex; flex-direction:column; gap:5px;"></div>
                </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" style="color: var(--g-red); border-color:var(--g-red);" onclick="UserManager.deleteUser()" id="deleteBtn">Delete</button>
                <button class="btn btn-primary" onclick="UserManager.submitUser()">Save User</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="trackerModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="trackerModalTitle">Add Card</h3>
                <button class="btn" onclick="ModalManager.closeModal('trackerModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editTrackerIndex" value="-1">
                <div class="type-selector" id="trackerTypeSelector">
                    <button id="typeGaugeBtn" class="type-option active" onclick="TrackerManager.setType('gauge')">Gauge</button>
                    <button id="typeLineBtn" class="type-option" onclick="TrackerManager.setType('line')">Time Series</button>
                    <button id="typeCounterBtn" class="type-option" onclick="TrackerManager.setType('counter')">Counter</button>
                    <button id="typeRagBtn" class="type-option" onclick="TrackerManager.setType('rag')">RAG Status</button>
                    <button id="typeNoteBtn" class="type-option" onclick="TrackerManager.setType('note')">Note</button>
                    <button id="typeCompletionBarBtn" class="type-option" onclick="TrackerManager.setType('completionBar')">Completion Bar</button>
                    <button id="typeDonutBtn" class="type-option" onclick="TrackerManager.setType('donut')">Donut Chart</button>
                    <button id="typeCountdownBtn" class="type-option" onclick="TrackerManager.setType('countdown')">Countdown</button>
                    <button id="typePlannerBtn" class="type-option" onclick="TrackerManager.setType('planner')">Resource Planner</button>
                </div>
                <div class="form-row" style="margin-bottom: 1rem; gap: 1rem;">
                    <div class="input-group" style="flex: 2;">
                        <label>Card Title</label>
                        <input type="text" id="tkDesc">
                    </div>
                    <div class="input-group" style="flex: 0 0 180px;" id="sizeContainer">
                        <label>Size</label>
                        <div id="tkSize" style="display:flex; gap:10px; margin-top:5px; flex-wrap:wrap;">
                            <label id="lblSize1x1" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="1x1"> 1x1</label>
                            <label id="lblSize2x1" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="2x1"> 2x1</label>
                            <label id="lblSize1x2" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="1x2"> 1x2</label>
                            <label id="lblSize2x2" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="2x2"> 2x2</label>
                            <label id="lblSize3x2" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="3x2"> 3x2</label>
                            <label id="lblSize2x3" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="2x3"> 2x3</label>
                            <label id="lblSize2x4" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="2x4"> 2x4</label>
                            <label id="lblSize3x3" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="3x3"> 3x3</label>
                            <label id="lblSize4x4" style="display:inline-flex; align-items:center; gap:3px; font-size:0.8rem;"><input type="radio" name="tkSize" value="4x4"> 4x4</label>
                        </div>
                    </div>
                </div>

                                <div id="gaugeInputs">

                                    <div class="input-group"><label>Metric Unit</label><input type="text" id="tkMetric" maxlength="15"></div>

                                    <div class="form-row" style="margin-bottom:0; gap:1rem;">

                                        <div class="input-group"><label>Target</label><input type="number" id="tkTotal"></div>

                                        <div class="input-group"><label>Progress</label><input type="number" id="tkComp"></div>

                                    </div>

                                    <div class="form-row" style="margin-top: 1rem; margin-bottom: 0; gap: 1rem;">

                                        <div class="input-group">

                                            <label>Target Colour</label>

                                            <input type="text" readonly class="color-input" id="tkPieColor" value="#696969">

                                        </div>

                                        <div class="input-group">

                                            <label>Progress Colour</label>

                                            <input type="text" readonly class="color-input" id="tkPieColor2" value="#228B22">

                                        </div>

                                    </div>

                                    <div class="input-group" style="margin-top: 1rem;">

                                        <label>Notes for Published View (Max 200 chars)</label>

                                        <textarea id="tkNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>

                                    </div>

                                </div>

                                <div id="lineInputs" style="display:none;">

                                    <div class="form-row" style="margin-bottom: 1rem; gap: 2rem;">

                                        <div class="input-group">

                                            <label>Metric Unit</label>

                                            <input type="text" id="tkYLabel" maxlength="15">

                                        </div>

                                        <div class="input-group">

                                            <label>Chart Style</label>

                                            <div style="display:flex; gap:15px; margin-top:5px;">

                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkDisplayStyle" value="line" checked> Line Chart</label>

                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkDisplayStyle" value="bar"> Bar Chart</label>

                                            </div>

                                        </div>

                                    </div>

                                    <div class="form-row" style="margin-bottom: 1rem; align-items: flex-end; display: flex; gap: 2rem;">

                                        <div class="input-group">

                                            <label>End Date</label>

                                            <input type="date" id="tkStartDate" onchange="TrackerManager.handleEndDateChange(this)" style="background:var(--input-bg); color:#fff; color-scheme:dark;">

                                        </div>

                                        <div class="input-group">

                                            <label>Time Unit</label>

                                            <div style="display: flex; gap: 15px; margin-top: 5px;" id="tkTimeUnitContainer">

                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkTimeUnit" value="day" checked onchange="TrackerManager.handleTimeUnitChange(this)"> Days</label>

                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkTimeUnit" value="month" onchange="TrackerManager.handleTimeUnitChange(this)"> Months</label>

                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkTimeUnit" value="year" onchange="TrackerManager.handleTimeUnitChange(this)"> Years</label>

                                            </div>

                                        </div>

                                        <div class="input-group">

                                            <label id="tkHistoricLabel">Historic Days</label>

                                            <select id="tkTimeCount" onchange="TrackerManager.handleCountChange(this)" style="width: 80px; min-width: 60px;"></select>

                                        </div>

                                    </div>

                                    <div class="input-group">

                                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">

                                            <label>Manual Data Entry</label>

                                        </div>

                                        <div id="lineTableContainer" style="max-height: 450px; overflow: auto; border: 1px solid #333; border-radius: 4px;"></div>

                                        <div style="margin-top: 10px; display:flex; justify-content:flex-end;">

                                            <button class="btn btn-sm" style="color:var(--g-red); border-color:var(--g-red); display: none;" onclick="TrackerManager.deleteSelectedSeries()">Delete Series</button>

                                        </div>

                                    </div>

                                    <div class="input-group" style="margin-bottom: 1rem; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px; margin-top: 1rem;">

                                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">

                                            <label style="margin:0;">Import / Export Data</label>

                                            <button class="btn btn-sm" onclick="TrackerManager.exportTimeSeriesCSV()">Export Table to CSV</button>

                                        </div>

                                        <textarea id="csvInput" placeholder="Paste CSV data here...&#10;Date, Series1, Series2...&#10;2023-01-01, 10, 20" style="height: 60px; font-family: monospace; font-size: 0.8rem;"></textarea>

                                        <button class="btn btn-sm" style="margin-top: 5px;" onclick="TrackerManager.parseCSV('line')">Parse CSV & Auto-fill</button>

                                    </div>

                                    <div class="input-group" style="margin-top: 1rem;">
                                        <label>Notes for Published View (Max 200 chars)</label>
                                        <textarea id="tkLineNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>
                                    </div>

                                </div>

                                                                                                <div id="completionbarInputs" style="display:none;">
                                                                                                    <div class="input-group">
                                                                                                        <label>Metric Unit</label>
                                                                                                        <input type="text" id="tkCompBarMetric" maxlength="15">
                                                                                                    </div>
                                                                                                    <div class="input-group">
                                                                                                        <label>Orientation</label>
                                                                                                        <div style="display:flex; gap:15px; margin-top:5px;">
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkCompBarOrient" value="horizontal" checked> Horizontal</label>
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkCompBarOrient" value="vertical"> Vertical</label>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="form-row" style="margin-bottom:0; gap:1rem;">
                                                                                                        <div class="input-group">
                                                                                                            <label>Target</label>
                                                                                                            <input type="number" id="tkCompBarTotal">
                                                                                                        </div>
                                                                                                        <div class="input-group">
                                                                                                            <label>Progress</label>
                                                                                                            <input type="number" id="tkCompBarActive">
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="form-row" style="margin-top: 1rem; margin-bottom: 0; gap: 1rem;">
                                                                                                        <div class="input-group">
                                                                                                            <label>Target Colour</label>
                                                                                                            <input type="text" readonly class="color-input" id="tkCompBarColorBg" value="#696969">
                                                                                                        </div>
                                                                                                        <div class="input-group">
                                                                                                            <label>Progress Colour</label>
                                                                                                            <input type="text" readonly class="color-input" id="tkCompBarColorVal" value="#228B22">
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="input-group" style="margin-top: 1rem;">
                                                                                                        <label>Notes for Published View (Max 200 chars)</label>
                                                                                                        <textarea id="tkCompBarNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>
                                                                                                    </div>
                                                                                                </div>

                                    <div id="plannerInputs" style="display:none;">
                                        <div class="input-group">
                                            <label>Range</label>
                                            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:5px;">
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="3" checked> 3 Months</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="6"> 6 Months</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="12"> 12 Months</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="18"> 18 Months</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="24"> 24 Months</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerRange" value="36"> 36 Months</label>
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <label>Tracking Type</label>
                                            <div style="display:flex; gap:15px; margin-top:5px;">
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerType" value="Role" checked onchange="TrackerManager.renderPlannerMultiSelect()"> Role</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerType" value="Task" onchange="TrackerManager.renderPlannerMultiSelect()"> Task</label>
                                                <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkPlannerType" value="Event" onchange="TrackerManager.renderPlannerMultiSelect()"> Event</label>
                                            </div>
                                        </div>
                                        <div class="input-group" id="plannerMultiSelectContainer" style="margin-top: 1rem; max-height: 150px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 4px; background: rgba(0,0,0,0.1);">
                                            <!-- Checkboxes will be injected here -->
                                        </div>
                                        <div class="input-group" style="margin-top: 1rem;">
                                            <label>Notes for Published View (Max 200 chars)</label>
                                            <textarea id="tkPlannerNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>
                                        </div>
                                    </div>
                
                <div id="counterInputs" style="display:none;">
                    <div class="input-group">
                        <label>Counters (Max 6)</label>
                        <div id="counterDataContainer" style="max-height: 300px; overflow-y: auto; border: 1px solid #333; padding: 10px; border-radius: 4px; background: rgba(0,0,0,0.1);">
                            <!-- Rows will be added here -->
                        </div>
                        <button class="btn btn-sm" style="margin-top: 10px;" onclick="TrackerManager.addCounterRow()">+ Add Counter</button>
                    </div>

                    <div class="input-group" style="margin-top: 1rem;">
                        <label>Notes for Published View (Max 200 chars)</label>
                        <textarea id="tkCounterNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>
                    </div>
                </div>

                                <div id="ragInputs" style="display:none;">

                                    <div class="input-group">

                                        <label>Status</label>

                                                                <div class="rag-selector">

                                                                    <div class="rag-pill" data-val="green" onclick="TrackerManager.selectRag('green')">

                                                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

                                                                          <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="#16A34A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                          <path d="M22 4L12 14.01L9 11.01" stroke="#16A34A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                        </svg>

                                                                    </div>

                                                                    <div class="rag-pill" data-val="amber" onclick="TrackerManager.selectRag('amber')">

                                                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

                                                                          <path d="M10.29 3.86L1.82 18C1.64556 18.3024 1.55293 18.6453 1.55196 18.9945C1.55098 19.3437 1.64171 19.6871 1.81506 19.991C1.98841 20.2949 2.23846 20.5487 2.54076 20.7275C2.84306 20.9063 3.18721 21.0041 3.54 21H20.46C20.8128 21.0041 21.1569 20.9063 21.4592 20.7275C21.7615 20.5487 22.0116 20.2949 22.1849 19.991C22.3583 19.6871 22.449 19.3437 22.448 18.9945C22.4471 18.6453 22.3544 18.3024 22.18 18L13.71 3.86C13.5317 3.56613 13.2807 3.32314 12.9812 3.15449C12.6817 2.98585 12.3437 2.89722 12 2.89722C11.6563 2.89722 11.3183 2.98585 11.0188 3.15449C10.7193 3.32314 10.4683 3.56613 10.29 3.86V3.86Z" fill="#D97706" stroke="#D97706" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                          <path d="M12 9V13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                          <path d="M12 17H12.01" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                        </svg>

                                                                    </div>

                                                                    <div class="rag-pill" data-val="red" onclick="TrackerManager.selectRag('red')">

                                                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

                                                                          <path d="M7.86 2H16.14L22 7.86V16.14L16.14 22H7.86L2 16.14V7.86L7.86 2Z" fill="#DC2626" stroke="#DC2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                          <path d="M15 9L9 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                          <path d="M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                        </svg>

                                                                    </div>

                                                                    <div class="rag-pill" data-val="grey" onclick="TrackerManager.selectRag('grey')">

                                                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

                                                                          <circle cx="12" cy="12" r="10" fill="#9CA3AF" />

                                                                          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>

                                                                        </svg>

                                                                    </div>

                                                                </div>

                                        <input type="hidden" id="tkRagStatus">

                                    </div>

                                                        <div class="input-group">

                                                            <label>Status Message</label>

                                                            <input type="text" id="tkRagMsg" maxlength="15" placeholder="e.g. All Systems Operational">

                                                        </div>

                                                        <div class="input-group" style="margin-top: 1rem;">

                                                            <label>Notes for Published View (Max 200 chars)</label>

                                                            <textarea id="tkRagNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>

                                                        </div>

                                                    </div>

                                                                                                <div id="noteInputs" style="display:none;">

                                                                                                    <div class="input-group">

                                                                                                        <label>Content (Markdown supported)</label>

                                                                                                        <textarea id="tkNoteContent" style="height: 200px; font-family: monospace;" placeholder="# Heading&#10;- Bullet&#10;**Bold**&#10;[Link](google.com)"></textarea>

                                                                                                    </div>

                                                                                                    <div class="input-group">
                                                                                                        <label>Text Alignment</label>
                                                                                                        <div style="display:flex; gap:15px; margin-top:5px;">
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkNoteAlign" value="left" checked> Left</label>
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkNoteAlign" value="center"> Center</label>
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkNoteAlign" value="right"> Right</label>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>

                                                                

                                                                                                <div id="donutInputs" style="display:none;">

                                                                                                    <div class="input-group">

                                                                                                        <label>Segments (Max 10)</label>

                                                                                                        <div id="donutDataContainer" style="max-height: 300px; overflow-y: auto; border: 1px solid #333; padding: 10px; border-radius: 4px; background: rgba(0,0,0,0.1);">

                                                                                                            <!-- Rows will be added here -->

                                                                                                        </div>

                                                                                                        <button class="btn btn-sm" style="margin-top: 10px;" onclick="TrackerManager.addDonutRow()">+ Add Segment</button>

                                                                                                    </div>

                                                                                                    <div class="input-group" style="margin-top: 1rem;">

                                                                                                        <label>Notes for Published View (Max 200 chars)</label>

                                                                                                        <textarea id="tkDonutNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>

                                                                                                    </div>

                                                                                                </div>

                                                                                                <div id="countdownInputs" style="display:none;">
                                                                                                    <div class="input-group">
                                                                                                        <label>Display Style</label>
                                                                                                        <div style="display:flex; gap:15px; margin-top:5px;">
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkCountdownStyle" value="list" checked> List</label>
                                                                                                            <label style="display:inline-flex; align-items:center; gap:5px;"><input type="radio" name="tkCountdownStyle" value="bar"> Bar Chart</label>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="input-group">
                                                                                                        <label>Events (Max 128)</label>
                                                                                                        <div id="countdownDataContainer" style="max-height: 300px; overflow-y: auto; border: 1px solid #333; padding: 10px; border-radius: 4px; background: rgba(0,0,0,0.1);"></div>
                                                                                                        <button class="btn btn-sm" style="margin-top: 10px;" onclick="TrackerManager.addCountdownRow()">+ Add Event</button>
                                                                                                    </div>
                                                                                                    <div class="input-group" style="margin-top: 1rem;">
                                                                                                        <label>Notes for Published View (Max 200 chars)</label>
                                                                                                        <textarea id="tkCountdownNotes" maxlength="200" style="height: 60px; font-size: 0.85rem;" placeholder="Enter details to display on hover..."></textarea>
                                                                                                    </div>
                                                                                                </div>

                                                                            </div>

                                                                            <div class="modal-footer">

                                                                                <button class="btn btn-primary" onclick="TrackerManager.submitTracker()">Save Card</button>

                                                                            </div>

                                                                        </div>

                                                                    </div>

    <div class="modal-overlay" id="assignmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="assignmentModalTitle">Add Assignment</h3>
                <button class="btn" onclick="ModalManager.closeModal('assignmentModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editAssignmentIndex" value="-1">
                <div class="input-group">
                    <label>Name</label>
                    <input type="text" id="asName" placeholder="e.g. Firewatch">
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="asDesc" style="height: 60px; font-size: 0.85rem;" placeholder="Brief description..."></textarea>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Class</label>
                        <select id="asClass" style="width: 100%; padding: 8px; background: var(--input-bg); color: #fff; border: 1px solid var(--border); border-radius: 4px;">
                            <option value="Role">Role</option>
                            <option value="Task">Task</option>
                            <option value="Project">Project</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Priority</label>
                        <div style="display: flex; gap: 10px; margin-top: 8px;">
                            <label style="font-size:0.85rem;"><input type="radio" name="asPriority" value="High"> High</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="asPriority" value="Med" checked> Med</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="asPriority" value="Low"> Low</label>
                        </div>
                    </div>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Start Date</label>
                        <input type="date" id="asStart" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                    <div class="input-group">
                        <label>End Date</label>
                        <input type="date" id="asEnd" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                </div>
                <div class="input-group">
                    <label>Colour tag</label>
                    <input type="text" readonly class="color-input" id="asColor" value="#03dac6" style="cursor:pointer;">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" style="color: var(--g-red); border-color:var(--g-red);" onclick="AssignmentManager.deleteAssignment()" id="btnDelAssignment">Delete</button>
                <button class="btn btn-primary" onclick="AssignmentManager.submitAssignment()">Save</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="roleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="roleModalTitle">Add Role</h3>
                <button class="btn" onclick="ModalManager.closeModal('roleModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editRoleIndex" value="-1">
                <div class="input-group">
                    <label>Role Name</label>
                    <input type="text" id="rlName" placeholder="e.g. System Administrator">
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="rlDesc" style="height: 60px; font-size: 0.85rem;" placeholder="Brief description..."></textarea>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Priority</label>
                        <div style="display: flex; gap: 10px; margin-top: 8px;">
                            <label style="font-size:0.85rem;"><input type="radio" name="rlPriority" value="High"> High</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="rlPriority" value="Med" checked> Med</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="rlPriority" value="Low"> Low</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Colour tag</label>
                        <input type="text" readonly class="color-input" id="rlColor" value="#03dac6" style="cursor:pointer;">
                    </div>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Start Date</label>
                        <input type="date" id="rlStart" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                    <div class="input-group">
                        <label>End Date</label>
                        <input type="date" id="rlEnd" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" style="color: var(--g-red); border-color:var(--g-red);" onclick="RoleManager.deleteRole()" id="btnDelRole">Delete</button>
                <button class="btn btn-primary" onclick="RoleManager.submitRole()">Save Role</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="eventModalTitle">Add Event</h3>
                <button class="btn" onclick="ModalManager.closeModal('eventModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editEventIndex" value="-1">
                <div class="input-group">
                    <label>Event Name</label>
                    <input type="text" id="evName" placeholder="e.g. Q4 Audit">
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="evDesc" style="height: 60px; font-size: 0.85rem;" placeholder="Brief description..."></textarea>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Priority</label>
                        <div style="display: flex; gap: 10px; margin-top: 8px;">
                            <label style="font-size:0.85rem;"><input type="radio" name="evPriority" value="High"> High</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="evPriority" value="Med" checked> Med</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="evPriority" value="Low"> Low</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Colour tag</label>
                        <input type="text" readonly class="color-input" id="evColor" value="#bb86fc" style="cursor:pointer;">
                    </div>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Start Date</label>
                        <input type="date" id="evStart" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                    <div class="input-group">
                        <label>End Date</label>
                        <input type="date" id="evEnd" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" style="color: var(--g-red); border-color:var(--g-red);" onclick="EventManager.deleteEvent()" id="btnDelEvent">Delete</button>
                <button class="btn btn-primary" onclick="EventManager.submitEvent()">Save Event</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="taskModalTitle">Add Task</h3>
                <button class="btn" onclick="ModalManager.closeModal('taskModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editTaskIndex" value="-1">
                <div class="input-group">
                    <label>Task Name</label>
                    <input type="text" id="tskName" placeholder="e.g. Update Documentation">
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="tskDesc" style="height: 60px; font-size: 0.85rem;" placeholder="Brief description..."></textarea>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Priority</label>
                        <div style="display: flex; gap: 10px; margin-top: 8px;">
                            <label style="font-size:0.85rem;"><input type="radio" name="tskPriority" value="High"> High</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="tskPriority" value="Med" checked> Med</label>
                            <label style="font-size:0.85rem;"><input type="radio" name="tskPriority" value="Low"> Low</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Colour tag</label>
                        <input type="text" readonly class="color-input" id="tskColor" value="#00e676" style="cursor:pointer;">
                    </div>
                </div>
                <div class="form-row" style="gap: 1rem; margin-bottom: 1rem;">
                    <div class="input-group">
                        <label>Start Date</label>
                        <input type="date" id="tskStart" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                    <div class="input-group">
                        <label>End Date</label>
                        <input type="date" id="tskEnd" style="background:var(--input-bg); color:#fff; color-scheme:dark;">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" style="color: var(--g-red); border-color:var(--g-red);" onclick="TaskManager.deleteTask()" id="btnDelTask">Delete</button>
                <button class="btn btn-primary" onclick="TaskManager.submitTask()">Save Task</button>
            </div>
        </div>
    </div>

    <!-- LOAD SCRIPT LAST to ensure it's available -->
    <!-- Changed to type="module" and added an export to window -->
    <script type="module">
        import * as AppModule from './app.js';
        
        // When module loads, expose it to window so HTML onclick works
        window.App = AppModule.App;
        window.UserManager = AppModule.UserManager;
        window.AssignmentManager = AppModule.AssignmentManager;
        window.RoleManager = AppModule.RoleManager;
        window.EventManager = AppModule.EventManager;
        window.TaskManager = AppModule.TaskManager;
        window.PlannerManager = AppModule.PlannerManager;
        window.TrackerManager = AppModule.TrackerManager;
        window.OverviewManager = AppModule.OverviewManager;
        window.ModalManager = AppModule.ModalManager;
        window.DataSaver = AppModule.DataSaver;
        window.DataLoader = AppModule.DataLoader;
        window.DataExporter = AppModule.DataExporter;
        window.Visuals = AppModule.Visuals;

        // When ready, remove loading overlay
        window.addEventListener('DOMContentLoaded', () => {
            window.App.init();
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => overlay.style.display = 'none', 100);
            }
        });
    </script>
</body>
</html>